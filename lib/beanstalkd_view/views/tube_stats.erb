<div class="row">
	<div class="col-md-7">
		<h1><%= @tube.name %></h1>

			<table class="table table-sm table-hover">
				<thead class="thead-light">
					<tr>
						<th colspan="2">Current Jobs</th>
					</tr>
				</thead>
				<tbody>
					<tr rel="tooltip" title="The number of ready jobs with priority < 1024 in this tube.">
						<td>Urgent</td>
							<% if @stats[:current_jobs_urgent] > 0 %>
								<td class="data_cell"><span class="badge badge-pill badge-primary"><%= @stats[:current_jobs_urgent] %></span></td>
							<% else %>
							<td class="data_cell">0</td>
							<% end %>
					</tr>
					<tr rel="tooltip" title="The number of jobs in the ready queue in this tube.">
						<td>Ready</td>
						<td class="data_cell"><%= @stats[:current_jobs_ready] %></td>
					</tr>
					<tr rel="tooltip" title="The number of jobs reserved by all clients in this tube.">
						<td>Reserved</td>
						<td class="data_cell"><%= @stats[:current_jobs_reserved] %></td>
					</tr>
					<tr rel="tooltip" title="The number of delayed jobs in this tube.">
						<td>Delayed</td>
						<td class="data_cell"><%= @stats[:current_jobs_delayed] %></td>
					</tr>
					<tr rel="tooltip" title="The number of buried jobs in this tube.">
						<td>Buried</td>
							<% if @stats[:current_jobs_buried] > 0 %>
								<td class="data_cell"><span class="badge badge-pill badge-danger"><%= @stats[:current_jobs_buried] %></span></td>
							<% else %>
							<td class="data_cell">0</td>
							<% end %>
					</tr>
			</tbody>
			</table>

			<table class="table table-sm table-hover">
				<thead class="thead-light">
					<tr>
						<th colspan="2">Statistics</th>
					</tr>
				</thead>
				<tbody>
					<tr rel="tooltip" title="The cumulative count of jobs created in this tube.">
						<td>Total Jobs</td>
						<td class="data_cell"><%= @stats[:total_jobs] %></td>
					</tr>
					<tr rel="tooltip" title="The number of open connections that have issued a reserve command while watching this tube but not yet received a response.">
						<td>Current Waiting</td>
						<td class="data_cell"><%= @stats[:current_waiting] %></td>
					</tr>
					<tr rel="tooltip" title="The number of seconds the tube has been paused for.">
						<td>Time Paused</td>
						<td class="data_cell"><%= @stats[:pause] %></td>
					</tr>
					<tr rel="tooltip" title="The number of seconds until the tube is un-paused.">
						<td>Pause Time Left</td>
						<% if @stats[:pause_time_left] > 0 %>
								<td class="data_cell"><span class="badge badge-pill badge-warning"><%= @stats[:pause_time_left] %></span></td>
							<% else %>
								<td class="data_cell">0</td>
							<% end %>
					</tr>
				</tbody>
			</table>

			<table class="table table-sm table-hover">
				<thead class="thead-light">
					<tr>
						<th colspan="2">API Call Histogram</th>
					</tr>
				</thead>
				<tbody>
					<tr rel="tooltip" title="The cumulative number of pause-tube commands for this tube.">
						<td>pause-tube</td>
						<td class="data_cell"><%= @stats[:cmd_pause_tube] %></td>
					</tr>
				</tbody>
			</table>
	</div>

	<div class="col-md-5">
		<h3>Pause Tube</h3>
		<form id="pause_form" class="well form-inline p-3" name="pause_form" action="<%= u("/pause") %>" method="POST">
			<input id="form_tube_name" type="hidden" name="tube" value="<%= @tube.name %>">
			<input id="form_url_base" type="hidden" name="url_base" value="<%= u("/") %>">
			<div class="form-group col-md-8 px-0">
				<input class="form-control w-100" type="text" placeholder="Number of seconds to wait" name="delay">
			</div>
			<div class="form-group col-md-4 px-0">
				<button class="btn btn-warning w-100 ml-md-3 mr-0" type="submit">Pause</button>
			</div>
		</form>

		<h3 class="mt-4">Clear Tube</h3>
		<form id="clear_form" class="well form-inline p-3" name="clear_form" action="<%= u("/clear") %>" method="POST">
			<input type="hidden" name="tube" value="<%= @tube.name %>">
			<input type="hidden" name="url_base" value="<%= u("/") %>">
			<div class="form-group col-md-8 px-0">
				<select class="form-control w-100" name="state">
					<option value="buried">Buried</option>
					<option value="ready">Ready</option>
					<option value="delayed">Delayed</option>
				</select>
			</div>
			<div class="form-group col-md-4 px-0">
				<button class="btn btn-danger w-100 ml-md-3 mr-0" type="submit">Clear</button>
			</div>
		</form>

		<h3 class="mt-4">Kick Tube (Retry)</h3>
		<form id="kick_form" class="well form-inline p-3" name="kick_form" action="<%= u("/kick") %>" method="POST">
				<input type="hidden" name="tube" value="<%= @tube.name %>">
			<div class="form-group col-md-8 px-0">
				<input class="form-control w-100" type="text" placeholder="Job number" name="bound">
			</div>
			<div class="form-group col-md-4 px-0">
				<button class="btn btn-warning w-100 ml-md-3 mr-0" type="submit">Kick</button>
			</div>
		</form>

		<h3 class="mt-4">Peek Jobs</h3>
		<form class="well p-3 spaced" name="peek_jobs">
			<a id="peek_ready_btn"	 href="#" class="btn btn-info">Peek Ready</a>
			<a id="peek_delayed_btn" href="#" class="btn btn-info">Peek Delayed</a>
			<a id="peek_buried_btn"	 href="#" class="btn btn-info mr-0">Peek Buried</a>
		</form>

		<h3 class="mt-4">Peek Range</h3>
		<form id="peek_range_form" class="well form-inline p-3" name="peek_range_form" action="<%= u("/peek-range") %>" method="GET">
			<input type="hidden" name="tube" value="<%= @tube.name %>">
			<div class="form-group col-md-4 px-0">
				<input type="text" class="form-control w-100" placeholder="0" name="min">
			</div>
			<div class="form-group col-md-4 px-0">
				<input type="text" class="form-control w-100 ml-md-1" placeholder="0" name="max">
			</div>
			<div class="form-group col-md-4 px-0">
				<button class="btn btn-info w-100 ml-md-3 mr-0" type="submit">Peek</button>
			</div>
		</form>
	</div>

	<%= erb :job_info_popup %>
</div>