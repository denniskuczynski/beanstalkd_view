<h1>Peek Range</h1>

<div class="row">
	<div class="col-md-12">
		<div class="alert alert-success">
			<strong>NOTE:</strong> Setting min and max to 0 will attempt to guess an appropriate range value based on the current ready queue.
		</div>

		<form class="well form-inline p-3" name="peek_range_form" action="<%= u("/peek-range") %>" method="GET">
			<div class="form-group col-md-2 px-0">
				<input class="form-control w-100" type="text" name="min" value="<%= @min %>">
			</div>
			<div class="form-group col-md-2 px-0">
				<input class="form-control w-100 ml-md-1" type="text" name="max" value="<%= @max %>">
			</div>
			<div class="form-group col-md-4 px-0">
				<select class="form-control w-100 ml-md-1" id="peek_range_tube_select" name="tube">
					<option></option>
					<% @tubes.each do |tube| %>
					<option <% if @tube and @tube.name == tube.name%>selected="true"<% end %>><%=tube.name%></option>
					<% end %>
				</select>
			</div>
			<div class="form-group col-md-4 px-0">
				<button type="submit" class="btn btn-primary ml-auto mr-0">Refresh</button>
			</div>
		</form>

		<table id="peek_range_table" class="mt-3 table table-bordered">
			<tr class="header">
				<th>ID</th>
				<th>Tube</th>
				<th>Priority</th>
				<th>Age</th>
				<th>Delay</th>
				<th>TTR</th>
				<th>Time Left</th>
				<th>Reserves</th>
				<th>Timeouts</th>
				<th>Releases</th>
				<th>Buries</th>
				<th>Kicks</th>
				<th>Body</th>
			</tr>
			<% @jobs.each do |job| %>
			<tr class="datum" data-tube="<%=job['tube']%>" <% if job['pri'] < 1024 %>class="urgent"<%end%>>
				<td><%=job['id']%></td>
				<td><%=job['tube']%></td>
				<td><%=job['pri']%></td>
				<td><%=job['age']%></td>
				<td><%=job['delay']%></td>
				<td><%=job['ttr']%></td>
				<td><%=job['time-left']%></td>
				<td><%=job['reserves']%></td>
				<td><%=job['timeouts']%></td>
				<td><%=job['releases']%></td>
				<td><%=job['buries']%></td>
				<td><%=job['kicks']%></td>
				<td><p class="peek_range_job_body"><%=job['body'].inspect%><p></td>
			</tr>
			<% end %>
		</table>
	</div>
</div>